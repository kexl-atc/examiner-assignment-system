# 智能考官排班系统功能修复与部署更新计划

## 📋 问题总结

经过全面排查，发现以下需要修复的问题：

### 🔴 严重问题

1. **前端源代码缺失**
   - 项目根目录缺少 `src/` 文件夹
   - 只有已编译的 `deploy/win7-package/frontend/` 文件
   - 无法进行前端开发和维护

2. **README.md Git冲突**
   - 文件包含 `<<<<<<< HEAD` 和 `>>>>>>> 88398a3` 标记
   - 需要解决冲突并合并内容

### 🟡 中等问题

3. **人工修改功能API缺口**
   - 缺少实时冲突检测API (`/api/learning/check-conflicts`)
   - 缺少推荐考官API (`/api/learning/recommendations`)
   - 输入验证需要增强
   - 缺少撤销修改功能

4. **部署脚本版本不一致**
   - `deploy.bat` 显示 v8.0.1
   - `package.json` 显示 v8.0.15
   - 需要统一版本号

### 🟢 优化建议

5. **文档更新**
   - 更新部署文档以反映最新功能
   - 确保文档与代码一致

---

## 🎯 修复计划

### 阶段1：紧急修复（必须完成）

#### 1.1 解决README.md冲突
- 合并两个版本的内容
- 保留完整的部署说明
- 确保格式正确

#### 1.2 统一版本号
- 将所有脚本中的版本号更新为 v8.0.15
- 更新 `deploy.bat`
- 更新 `deploy/scripts/build-package.bat`
- 更新 `deploy/win7-package/VERSION.txt`

#### 1.3 恢复前端源代码
- 从已编译文件推断源代码结构
- 重建 `src/` 目录结构
- 创建核心Vue组件和TypeScript文件
- 确保项目可以正常构建

### 阶段2：功能完善（重要）

#### 2.1 实现人工修改API
- 添加 `ConflictCheckRequest` DTO
- 添加 `ConflictCheckResponse` DTO
- 实现 `/api/learning/check-conflicts` 端点
- 实现 `/api/learning/recommendations` 端点
- 增强输入验证

#### 2.2 添加撤销功能
- 实现 `/api/learning/manual-edit/{id}/revert` 端点
- 添加撤销记录逻辑

### 阶段3：部署更新（重要）

#### 3.1 更新部署脚本
- 修正版本号
- 更新启动脚本
- 更新停止脚本
- 更新文档

#### 3.2 重新构建部署包
- 构建前端
- 构建后端
- 打包到 `deploy/win7-package/`

---

## 📝 详细任务清单

### 任务1：解决README.md冲突
- [ ] 读取当前README.md
- [ ] 识别冲突内容
- [ ] 合并两个版本
- [ ] 测试格式正确性

### 任务2：统一版本号
- [ ] 更新 `deploy.bat` (第9行)
- [ ] 更新 `deploy/scripts/build-package.bat` (第5行)
- [ ] 更新 `deploy/win7-package/VERSION.txt`
- [ ] 验证所有版本号一致

### 任务3：恢复前端源代码
- [ ] 创建 `src/` 目录结构
- [ ] 创建 `src/main.ts`
- [ ] 创建 `src/App.vue`
- [ ] 创建核心页面组件
- [ ] 创建API服务文件
- [ ] 创建类型定义文件
- [ ] 配置路由
- [ ] 测试构建

### 任务4：实现人工修改API
- [ ] 创建 `ConflictCheckRequest.java`
- [ ] 创建 `ConflictCheckResponse.java`
- [ ] 在 `LearningResource.java` 添加 `checkConflicts` 方法
- [ ] 在 `LearningResource.java` 添加 `getRecommendations` 方法
- [ ] 增强 `recordManualEdit` 验证
- [ ] 添加 `revertManualEdit` 方法
- [ ] 编译测试

### 任务5：更新部署文件
- [ ] 更新 `deploy/scripts/build-package.bat`
- [ ] 更新 `deploy/win7-package/VERSION.txt`
- [ ] 更新 `deploy/win7-package/README.txt`
- [ ] 更新 `deploy/win7-package/INSTALLATION.md`

### 任务6：重新构建
- [ ] 运行 `npm run build:prod`
- [ ] 运行 `cd optaplanner-service && mvn clean package -Pproduction -DskipTests`
- [ ] 运行 `deploy/scripts/build-package.bat`
- [ ] 验证部署包完整性

---

## ⏱️ 预计时间

| 阶段 | 任务 | 预计时间 |
|------|------|----------|
| 阶段1 | 解决README冲突 | 15分钟 |
| 阶段1 | 统一版本号 | 10分钟 |
| 阶段1 | 恢复前端源代码 | 2-3小时 |
| 阶段2 | 实现人工修改API | 2小时 |
| 阶段3 | 更新部署文件 | 30分钟 |
| 阶段3 | 重新构建 | 30分钟 |
| **总计** | | **约5-6小时** |

---

## ✅ 验收标准

1. README.md无冲突，内容完整
2. 所有版本号统一为 v8.0.15
3. 前端源代码完整，可以正常构建
4. 人工修改API完整实现
5. 部署包可以正常构建和运行
6. 所有功能测试通过

---

## 🚀 开始执行

确认此计划后，我将按顺序执行所有任务，确保系统功能完整且部署文件更新。