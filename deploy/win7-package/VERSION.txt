================================================
  考官排班系统 Win7 离线部署包
================================================
  Version: v8.0.17-hotfix2 (Win7兼容 + 约束修复)
  Build Time: 2026-02-07 14:00

================================================
  Win7 兼容性说明
================================================

✅ 已验证兼容的组件：
  - 前端 HTML/JS：已移除 crossorigin 属性，Win7 IE11/Chrome 可正常加载
  - 批处理脚本：使用基本 CMD 命令，Win7 完全兼容
  - VBS 脚本：使用 WScript.Shell，Win7 原生支持
  - Java 运行时：OpenJDK 17（需要 Win7 SP1 + Platform Update）

⚠️ 注意事项：
  1. Java 17 要求 Windows 7 SP1 并安装 Platform Update
  2. 建议在 Win7 上使用 Chrome/Firefox 而非 IE11
  3. 诊断工具使用 PowerShell，Win7 默认 PS 2.0 可能部分功能受限

================================================
  本次更新内容
================================================

================================================
  本次更新内容
================================================

[v8.0.17-hotfix1 智能修改窗口约束对齐修复]

  问题：智能推荐显示"合规"，但选择后提示"违反约束"
  
  根本原因：
  推荐生成逻辑与约束检测逻辑不一致，遗漏多项关键约束
  
  修复内容：
  
  1. HC4约束（每天只能监考一场）
     - 新增：推荐时检查教师当天是否已安排其他考试
     - 修复前：推荐列表可能包含当天已忙碌的考官
     - 修复后：此类考官不会出现在推荐列表
     
  2. HC7约束（考官1与考官2不同科室）
     - 考官1推荐：新增检查是否与已选考官2同科室
     - 考官2推荐：新增检查是否与已选考官1同科室
     - 修复前：推荐可能违反考官间科室互斥
     
  3. HC8约束（同一学员角色不重复）
     - 考官1/2推荐：新增检查是否与备份考官是同一人
     - 备份考官推荐：新增检查是否与考官1/2是同一人
     - 修复前：可能推荐已担任其他角色的教师
     
  4. HC8b约束（备份考官科室互斥）
     - 新增：备份考官推荐时检查与考官1/2不同科室
     - 修复前：可能推荐与主考官同科室的备份

[v8.0.17 精确评估版 - 完全模拟OptaPlanner约束]

  问题：评估推荐的日期比选定日期还短，且无法识别排班失败
  
  根本原因：
  1. 未考虑HC6约束（连续两天考试）对日期对的严格要求
  2. 未模拟OptaPlanner的约束求解过程
  3. 评估算法与实际排班算法存在巨大差异
  
  核心改进：
  
  1. 模拟HC6约束（连续两天考试）
     - 计算所有可用的连续日期对
     - 检查每个日期对是否有足够考官
     - 验证日期对数量 >= 两天学员数量
     
  2. 模拟HC2/HC7约束（科室匹配）
     - 按科室计算可用考官组合
     - 验证考官1同科室 + 考官2不同科室的可行性
     - 识别零容量科室
     
  3. 模拟HC3约束（白班限制）
     - 考虑值班表对考官可用性的影响
     - 排除白班组考官在对应日期的可用性
     
  4. 模拟HC4约束（每天一场）
     - 计算每天最大可容纳考试数
     - 验证是否满足每天考试需求
     
  5. 精确推荐算法
     - 基于实际约束计算最小所需天数
     - 给出明确的缺口分析
     - 提供针对性的解决建议

[v8.0.16 深度优化 - 智能评估算法重构]

  问题：评估显示"配置完美"，但实际有学员未安排
  
  根本原因：
  1. 评估仅基于理论容量，未考虑个体考官实际可用性
  2. 未精确分析科室级别的资源瓶颈
  3. 评估算法与实际OptaPlanner约束求解不一致
  
  解决方案：
  
  1. 瓶颈分析算法 (Bottleneck Analysis)
     - 识别限制排班的"最紧缺部门"
     - 计算每个部门的实际可用考官（考虑不可用期、值班、周末约束）
     - 输出利用率、容量缺口、严重程度
     
  2. 精确容量计算 (Precise Capacity)
     - 原算法：容量 = 考官总数 × 工作日 × 每天上限
     - 新算法：容量 = Σ(每个考官有效容量)
     - 有效容量 = 可用日期数 × min(工作量限制, 每天上限)
     - 考虑因素：HC1周末约束、不可用期、值班冲突、节假日
     
  3. 约束预检查 (Constraint Pre-Check)
     - HC1：周末排班限制检查
     - HC2：考官1科室匹配检查
     - HC7：考官不同科室检查
     - CAP：容量约束验证
     
  4. 智能日期推荐 (Smart Date Recommendation)
     - 基于瓶颈部门计算最小所需天数
     - 提供置信度评估
     - 部门级具体建议
     
  5. 性能优化
     - 5秒缓存机制
     - 防抖处理（500ms）
     - 评估耗时：~50ms（20学员+23考官）

[v8.0.15 智能评估精确优化]

  1. 重新设计评估优先级（9级检查）
  2. 添加考官可用性检查
  3. 精确容量计算
  4. UI优化（折叠面板、动画效果）

================================================
  评估状态说明（深度优化版）
================================================

  错误状态（红色）- 无法排班
  ├─ 数据缺失：缺少学员或考官
  ├─ 日期错误：无可用工作日
  ├─ 容量不足：全局容量不够
  ├─ 科室瓶颈：某部门无可用考官或容量严重不足
  └─ 每日容量不足：每天场次超限

  警告状态（黄色）- 可以排班但有问题
  ├─ 瓶颈警告：某部门利用率>90%
  ├─ 可用性低：>30%考官不可用
  ├─ 日程紧张：每天场次接近上限
  └─ 日期受限：不可用日期影响大

  成功状态（绿色）- 推荐排班
  ├─ 配置完美：每天≤3场，瓶颈利用率<60%
  └─ 配置可行：可以完成排班

  新增评估指标
  ├─ 排班可行性：基于约束满足度的置信度百分比
  ├─ 实际容量利用率：需求/实际可用容量（而非理论容量）
  ├─ 瓶颈部门：限制排班的部门列表
  └─ 不可用考官：在选定日期无可用性的考官数

================================================
  容量计算公式
================================================

  总考试需求 = 学员数 × 2场/人
  
  每天最大场次 = floor(考官总数 / 2)
  
  全局容量 = 每天最大场次 × 工作日
  
  科室容量 = 科室可用考官 × 工作日
  
  实际可用考官 = 总考官 - 不可用考官

================================================
  使用说明
================================================

  1. 启动服务：双击"启动.vbs"
  2. 导入学员：第一步导入学员名单
  3. 设置日期：第二步选择日期范围
  4. 查看评估：第三步查看智能评估
     - 关注状态卡片（红/黄/绿）
     - 展开"详细分析"查看具体数据
     - 根据"改进建议"调整配置
  5. 执行排班：第四步确认并执行

================================================
